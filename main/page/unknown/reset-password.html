<main>
  <style>
    html {
      --main-wrap-bg: white;
      --main-wrap-border-color: #4A55FF;
      --main-form-label-color: black;
      --main-form-input-color: black;
      --main-form-input-border-color: var(--black-color-300);
      --main-form-option-bg: white;
      --main-form-option-border-color: #989898;
      --main-form-option-font-color: black;
    }

    html[theme=dark] {
      --main-wrap-bg: black;
      --main-wrap-border-color: #4A55FF;
      --main-form-label-color: white;
      --main-form-input-color: white;
      --main-form-input-border-color: white;
      --main-form-option-bg: var(--black-color-800);
      --main-form-option-border-color: #989898;
      --main-form-option-font-color: white;
    }

    main {
      padding: 40px 100px;
      width: min(100vw, 1440px);
      min-height: 100dvh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding-top: 50px;
    }

    main .wrapper {
      display: inline-flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      border-radius: 24px;
      border: 1px solid var(--main-wrap-border-color);
      background: var(--main-wrap-bg);
      padding: 16px;
      margin-block: 32px;
    }

    main .wrapper h1 {
      font-size: 32px;
      font-weight: 500;
      background: var(--main-color);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    main .wrapper form {
      margin-top: 32px;
      display: inline-flex;
      flex-direction: column;
    }

    main .wrapper form .email,
    main .wrapper form .password {
      display: inline-flex;
      flex-direction: column;
    }

    main .wrapper form .password {
      margin-top: 24px;
    }

    main .wrapper form div label {
      font-size: 16px;
      font-weight: 400;
      margin-bottom: 8px;
      color: var(--main-form-label-color);
    }

    main .wrapper form div input {
      width: min(400px, 80vw);
      padding: 8px 16px;
      border-radius: 8px;
      border: 0.5px solid var(--main-form-input-border-color);
      font-size: 16px;
      font-weight: 400;
      outline: none;
      color: var(--main-form-input-color);
      background: none;
    }

    main .wrapper form .submit {
      width: 100%;
      padding: 8px;
      border-radius: 16px;
      background: var(--main-color);
      box-shadow: 2px 2px 8px 2px rgba(255, 255, 255, 0.15);
      font-size: 20px;
      font-weight: 500;
      color: white;
      cursor: pointer;
      margin-top: 32px;
      border: none;
    }

    main .wrapper form .submit:hover {
      filter: brightness(90%);
    }

    main .wrapper .submenu {
      display: inline-flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 24px;
      width: 100%;
    }

    main .wrapper .submenu p {
      font-size: 16px;
      font-weight: 400;
      cursor: pointer;
      color: var(--main-form-option-font-color);
    }

    main .wrapper .submenu p:hover {
      opacity: .8;
    }

    main .wrapper .separate {
      margin-top: 20px;
      width: 100%;
      display: inline-flex;
      flex-direction: column;
    }

    main .wrapper .separate p {
      text-align: center;
      transform: translateY(-50%);
      background: var(--main-wrap-bg);
      color: var(--main-form-option-font-color);
      width: fit-content;
      align-self: center;
      padding-inline: 12px;
    }

    main .wrapper .options {
      display: inline-flex;
      flex-direction: column;
      row-gap: 8px;
      width: 100%;
    }

    main .wrapper .options button {
      width: 100%;
      display: inline-flex;
      padding: 12px;
      align-items: center;
      justify-content: center;
      column-gap: 12px;
      border-radius: 16px;
      border: 0.5px solid var(--main-form-option-border-color);
      box-shadow: 2px 2px 8px 2px rgba(255, 255, 255, 0.15);
      cursor: pointer;
      background: var(--main-form-option-bg);
    }

    main .wrapper .options button:hover {
      opacity: .8;
    }

    main .wrapper .options button p {
      font-size: 16px;
      font-weight: 400;
      color: var(--main-form-option-font-color);
    }

    main .wrapper .options button svg {
      width: 28px;
      height: 28px;
    }

    main .success-wrapper {
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      border-radius: 16px;
      border: 1px solid var(--main-wrap-border-color);
      background: var(--main-wrap-bg);
      padding: 16px;
      margin-block: 32px;
      width: min(100%, 550px);
    }

    main .success-wrapper.show {
      display: inline-flex;
    }

    main .success-wrapper h1 {
      font-size: 28px;
      font-weight: 500;
      color: black;
      text-align: center;
    }

    main .success-wrapper h2 {
      margin-top: 8px;
      font-size: 20px;
      font-weight: 300;
      color: var(--black-color-500);
      text-align: center;
    }

    @media (max-width: 1024px) {
      main {
        padding-inline: 80px;
      }
    }

    @media (max-width: 768px) {
      main {
        padding-inline: 50px;
      }

      main .wrapper .options button {
        column-gap: 8px;
      }

      main .wrapper .options button p {
        font-size: 14px;
      }

      main .wrapper .options button svg {
        width: 24px;
        height: 24px;
      }
    }

    @media (max-width: 425px) {
      main {
        padding-inline: 20px;
      }
    }
  </style>
  <div class="wrapper">
    <h1>รีเซ็ทรหัสผ่าน</h1>
    <form onsubmit="return false">
      <div class="email">
        <label for="email_input">Email</label>
        <input type="email" id="email_input" placeholder="example@domain.tld">
      </div>
      <button type="button" class="submit" id="next_button">ถัดไป</button>
    </form>
    <div class="submenu">
      <p onclick="Route.goto('/register')">สร้างบัญชีใหม่</p>
      <p onclick="Route.goto('/login')">เข้าสู่ระบบ</p>
    </div>
  </div>
  <div class="success-wrapper">
    <h1>ระบบส่งลิ้งค์รีเซ็ทรหัสผ่านให้ท่านแล้ว</h1>
    <h2>กรุณาตรวจสอบกล่องจดหมายอีเมลของท่าน<br>หากไม่พบให้ลองตรวจสอบที่จดหมายสแปม</h2>
  </div>
  <script>
    const email_input = document.querySelector("#email_input");
    var in_process = false;

    document.querySelector("#next_button").addEventListener("click", e => {
      e.preventDefault();

      if (in_process) return;

      in_process = true;

      document.querySelector("#next_button").textContent = "กรุณารอสักครู่";

      if (email_input.value == "") {
        alert("กรุณากรอกข้อมูลอีเมล")
        return;
      }

      fetch(SETTING.Server + "/reset-password", {
        method: "POST",
        cache: "no-cache",
        headers: {
          'Content-Type': 'application/json'
        },
        body: API.postBody({
          email: email_input.value
        })
      }).then(res => {
        return res.json();
      }).then(info => {

        if (info.detail) {
          alert("เกิดข้อผิดพลาด ไม่สามารถรีเซ็ทรหัสผ่านได้: " + info.detail.text)
          document.querySelector("#next_button").textContent = "ถัดไป";
          in_process = false;
          return;
        }

        if (info.data.success) {
          document.querySelector("main .wrapper").remove();
          document.querySelector("main .success-wrapper").classList.add("show");
        } else {
          alert("เกิดข้อผิดพลาด ไม่สามารถรีเซ็ทรหัสผ่านได้: " + info.text);
          document.querySelector("#next_button").textContent = "ถัดไป";
          in_process = false;
        }
      });
    })
  </script>
</main>
{{structure_script}}